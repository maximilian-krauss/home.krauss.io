{{#> layout title="Sensordata - Krausshalt"}}

{{#*inline "body"}}

<div class="Box Box--blue Box--condensed m-2 mb-3">
  <div class="Box-header">
    <h2 class="Box-title">
      <img class="avatar avatar-small mr-2" alt="{{currentWeather.description}}" src="{{currentWeather.icon}}" width="32" height="32" />
      Current Weather: {{currentWeather.description}}
    </h2>
  </div>
  <div class="Box-row">
    <div class="container-lg clearfix">
      <div class="col-6 float-left border-right p-2">
        <h2 class="text-center">{{currentWeather.temperature}}°C</h2>
      </div>
      <div class="col-6 float-right p-2">
        <h2 class="text-center">{{currentWeather.humidity}}%</h2>
      </div>
    </div>
  </div>
  <div class="Box-footer d">
    <strong>Last update: </strong> <span class="date-time" title="{{currentWeather.last_update}}" data-time="{{currentWeather.last_update}}"></span>
  </div>
</div>

{{#each sensorData}}
<div class="Box Box--condensed m-2 mb-3">
  <div class="Box-header">
    <h2 class="Box-title">
      <img class="avatar avatar-small mr-2" alt="" src="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEyIDUxMiIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxwYXRoIGQ9Im00MzcuMDY2IDc0Ljk4MWMtNS44NTctNS44NTgtMTUuMzU1LTUuODU4LTIxLjIxMyAwcy01Ljg1OCAxNS4zNTUgMCAyMS4yMTNjNDIuNjU2IDQyLjY1NSA2Ni4xNDcgOTkuNDA5IDY2LjE0NyAxNTkuODA2cy0yMy40OTEgMTE3LjE1MS02Ni4xNDcgMTU5LjgwNmMtNS44NTggNS44NTctNS44NTggMTUuMzU1IDAgMjEuMjEzIDUuODY4IDUuODY4IDE1LjM2NSA1Ljg0OCAyMS4yMTMgMCA0OC4zMjItNDguMzIxIDc0LjkzNC0xMTIuNjA4IDc0LjkzNC0xODEuMDE5cy0yNi42MTItMTMyLjY5OC03NC45MzQtMTgxLjAxOXoiLz48cGF0aCBkPSJtMzkxLjY0NiAxMjAuNGMtNS44NTgtNS44NTctMTUuMzU2LTUuODU3LTIxLjIxMyAwLTUuODU3IDUuODU4LTUuODU3IDE1LjM1NSAwIDIxLjIxMyAzMC41MzMgMzAuNTMxIDQ3LjM0OSA3MS4xNTUgNDcuMzQ5IDExNC4zODdzLTE2LjgxNSA4My44NTUtNDcuMzQ5IDExNC4zODdjLTUuODU4IDUuODU4LTUuODU4IDE1LjM1NSAwIDIxLjIxMyA1Ljg1NiA1Ljg1NiAxNS4zNTMgNS44NTkgMjEuMjEzIDAgMzYuMi0zNi4xOTggNTYuMTM2LTg0LjM1NSA1Ni4xMzYtMTM1LjYwMXMtMTkuOTM3LTk5LjQwMi01Ni4xMzYtMTM1LjU5OXoiLz48cGF0aCBkPSJtMzQ2LjE5MyAxNjUuODUyYy01Ljg1OC01Ljg1Ny0xNS4zNTYtNS44NTctMjEuMjEzIDAtNS44NTggNS44NTgtNS44NTcgMTUuMzU2IDAgMjEuMjEzIDE4LjQgMTguMzk4IDI4LjUzMyA0Mi44OCAyOC41MzMgNjguOTM0cy0xMC4xMzMgNTAuNTM2LTI4LjUzMyA2OC45MzRjLTUuODU4IDUuODU3LTUuODU4IDE1LjM1NSAwIDIxLjIxMyA1Ljg1NyA1Ljg1NyAxNS4zNTQgNS44NTkgMjEuMjEzIDAgMjQuMDY2LTI0LjA2NSAzNy4zMi01Ni4wOCAzNy4zMi05MC4xNDhzLTEzLjI1NC02Ni4wODEtMzcuMzItOTAuMTQ2eiIvPjxwYXRoIGQ9Im0zMCAyNTZjMC02MC4zOTcgMjMuNDkxLTExNy4xNTEgNjYuMTQ3LTE1OS44MDYgNS44NTgtNS44NTcgNS44NTgtMTUuMzU1IDAtMjEuMjEzLTUuODU3LTUuODU3LTE1LjM1NC01Ljg1OC0yMS4yMTMgMC00OC4zMjIgNDguMzIxLTc0LjkzNCAxMTIuNjA4LTc0LjkzNCAxODEuMDE5czI2LjYxMiAxMzIuNjk4IDc0LjkzNCAxODEuMDE5YzUuODU2IDUuODU3IDE1LjM1NSA1Ljg1OSAyMS4yMTMgMCA1Ljg1OC01Ljg1OCA1Ljg1OC0xNS4zNTUgMC0yMS4yMTMtNDIuNjU2LTQyLjY1NS02Ni4xNDctOTkuNDA5LTY2LjE0Ny0xNTkuODA2eiIvPjxwYXRoIGQ9Im05NC4yMTkgMjU2YzAtNDMuMjMyIDE2LjgxNS04My44NTUgNDcuMzQ5LTExNC4zODcgNS44NTgtNS44NTggNS44NTgtMTUuMzU1IDAtMjEuMjEzLTUuODU3LTUuODU4LTE1LjM1NS01Ljg1Ny0yMS4yMTMgMC0zNi4yIDM2LjE5Ny01Ni4xMzYgODQuMzU1LTU2LjEzNiAxMzUuNnMxOS45MzYgOTkuNDAzIDU2LjEzNiAxMzUuNjAxYzUuODY2IDUuODY1IDE1LjM2MyA1Ljg1IDIxLjIxMyAwIDUuODU3LTUuODU4IDUuODU3LTE1LjM1NSAwLTIxLjIxMy0zMC41MzQtMzAuNTMyLTQ3LjM0OS03MS4xNTYtNDcuMzQ5LTExNC4zODh6Ii8+PHBhdGggZD0ibTE4Ny4wMjEgMTY1Ljg1M2MtNS44NTctNS44NTgtMTUuMzU1LTUuODU4LTIxLjIxMyAwLTI0LjA2NiAyNC4wNjUtMzcuMzIgNTYuMDgtMzcuMzIgOTAuMTQ4czEzLjI1NCA2Ni4wODMgMzcuMzIgOTAuMTQ4YzUuODY2IDUuODY1IDE1LjM2MyA1Ljg1IDIxLjIxMyAwIDUuODU4LTUuODU4IDUuODU3LTE1LjM1NiAwLTIxLjIxMy0xOC40LTE4LjM5OC0yOC41MzMtNDIuODgtMjguNTMzLTY4LjkzNHMxMC4xMzMtNTAuNTM2IDI4LjUzMy02OC45MzRjNS44NTctNS44NTkgNS44NTctMTUuMzU3IDAtMjEuMjE1eiIvPjxwYXRoIGQ9Im0yNTYgMTkyLjhjLTM0Ljg0OSAwLTYzLjIgMjguMzUyLTYzLjIgNjMuMnMyOC4zNTIgNjMuMiA2My4yIDYzLjIgNjMuMi0yOC4zNTIgNjMuMi02My4yLTI4LjM1MS02My4yLTYzLjItNjMuMnoiLz48L2c+PC9zdmc+" width="32" height="32" />
      {{alias}}
      <span class="Counter Counter--gray-dark" title="{{battery}}% battery left">{{battery}}%</span>
    </h2>
  </div>
  <div class="Box-row">
    <div class="container-lg clearfix">
      <div class="col-6 float-left border-right p-2">
        <h2 class="text-center">{{temperature}}°C</h2>
      </div>
      <div class="col-6 float-right p-2">
        <h2 class="text-center">{{humidity}}%</h2>
      </div>
    </div>
  </div>
  <div class="Box-footer">
    <span class="Counter--gray-dark" >
      Last update: <span class="date-time" title="{{last_update}}" data-time="{{last_update}}"></span>
    </span>
  </div>
</div>
{{/each}}

<script type="text/javascript">
  const documentReady = function(){
    const dateTimeElements = document.getElementsByClassName('date-time')
    for(const element of dateTimeElements) {
      const parsedDate = moment(element.getAttribute('data-time')).local()
      const difference = parsedDate.diff(moment())
      const duration = moment.duration(difference).humanize()
      element.innerHTML = `${duration} ago`
    }
  }

  if (document.readyState === "complete" || (document.readyState !== "loading" && !document.documentElement.doScroll)) {
    documentReady();
  } else {
    document.addEventListener("DOMContentLoaded", documentReady);
  }

</script>

{{/inline}}

{{/layout}}